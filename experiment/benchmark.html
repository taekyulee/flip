<html><head><title>Flip: Benchmark</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Flip contributors" /><meta name="description" content="Fast and lightweight probability tools for a dataset and a data stream" /><meta name="og:image" content="/flip/img/poster.png" /><meta name="og:title" content="Flip: Benchmark" /><meta name="og:site_name" content="Flip" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Fast and lightweight probability tools for a dataset and a data stream" /><link rel="icon" type="image/png" href="/flip/img/favicon.png" /><meta name="twitter:title" content="Flip: Benchmark" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="Fast and lightweight probability tools for a dataset and a data stream" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:creator" content="@xxxnell" /><link rel="icon" type="image/png" sizes="16x16" href="/flip/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/flip/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/flip/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/flip/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/flip/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/flip/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/flip/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/flip/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/flip/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/flip/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/flip/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/flip/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/flip/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/flip/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/flip/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/flip/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/flip/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/flip/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/flip/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/flip/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/flip/highlight/styles/atom-one-light.css" /><link rel="stylesheet" href="/flip/css/style.css" /><link rel="stylesheet" href="/flip/css/palette.css" /><link rel="stylesheet" href="/flip/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/flip/" class="brand"><div class="brand-wrapper"><span>Flip</span></div></a></li>    <li><a href="/flip/experiments.html" class="">Experiments</a></li> <li><a href="/flip/experiment/parameters.html" class="">Performance on Parameters</a></li> <li><a href="/flip/experiment/benchmark.html" class=" active ">Benchmark</a></li> <li><a href="/flip/experiment/accuracy.html" class="">Accuracy on Data Streams</a> <ul class="sub_section"> <li><a href="/flip/experiment/accuracyonstat.html" class="">Stationary Case</a></li> <li><a href="/flip/experiment/accuracyonnonstat.html" class="">Non-stationary Case</a></li></ul></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/xxxnell/flip"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/xxxnell/flip"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('Flip Fast and lightweight probability tools for a dataset and a data stream');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('Flip Fast and lightweight probability tools for a dataset and a data stream');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="xxxnell" data-github-repo="flip"><div class="content-wrapper"><section><h1 id="benchmark">Benchmark</h1>

<p><em>Flip</em> claims a fast and lightweight library, so reducing computation cost and memory consumption is one of the most important goals. As shown in the benchmark below, <em>Flip</em> is not only easy to use, but also the best performance library for statistical processing of dataset as a performance aspect.</p>

<p>All benchmarks are using version <a href="https://github.com/xxxnell/flip/tree/v0.0.2">v0.0.2</a>.</p>

<h2 id="sketch-time-performance"><code class="highlighter-rouge">Sketch</code> time performance</h2>

<p>The table below shows the result of execution time benchmark for the primary functions of <code class="highlighter-rouge">Sketch</code> in nanosecond (ns) units for cases where queueSize is 0 and 50. The benchmark environment is the Macbook Pro 2016 with 2.9 GHz Intel Core i5 and 16 GB Memory. I used <a href="http://openjdk.java.net/projects/code-tools/jmh/">jmh</a> as a benchmark tool. The result is a 20 iteration warm-up and averaged 30 iteration measured. The configuration of <code class="highlighter-rouge">Sketch</code> uses cmapSize as 20, cmapNo as 2, and an uncompressed counter. You can also benchmark yourself with the <a href="../../../../../flip-bench/README.md">benchmark</a> document.</p>

<table>
  <thead>
    <tr>
      <th>function</th>
      <th>queueSize = 0</th>
      <th>queueSize = 50</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">construct</code></td>
      <td>711</td>
      <td>730</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">count</code></td>
      <td>1,462</td>
      <td>2,201</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">probability</code></td>
      <td>2,186</td>
      <td>3,738</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">sampling</code></td>
      <td>96,532</td>
      <td>117,741</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">narrowUpdate</code></td>
      <td>418</td>
      <td>847</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">deepUpdate</code></td>
      <td>478,737</td>
      <td>354,757</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">rearrange</code></td>
      <td>361,937</td>
      <td>1,212,996</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">pure</code></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">map</code></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">flatMap</code></td>
      <td>1,564,522</td>
      <td>1,409,802</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">median</code></td>
      <td>208,418</td>
      <td>308,059</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">sample</code></td>
      <td>159,117</td>
      <td>155,688</td>
    </tr>
  </tbody>
</table>

<h2 id="comparison-of-several-density-estimation-algorithms">Comparison of several density estimation algorithms</h2>

<p>To evaluate the performance of <em>Flip</em>, I compare it with nonparametric density estimation algorithms such as the conventional histogram and <a href="https://github.com/joluet/okde-java">online kernel density estimation</a>.</p>

<p>The extensible histogram, or xHistogram for short, to be used as the histogram here, is a special case of <code class="highlighter-rouge">Sketch</code> of <em>Flip</em>. Update process of <code class="highlighter-rouge">Sketch</code> internally divides into two types: <code class="highlighter-rouge">narrowUpdate</code> and <code class="highlighter-rouge">deepUpdate</code>. <code class="highlighter-rouge">narrowUpdate</code> changes count only, not bin, while <code class="highlighter-rouge">deepUpdate</code> changes both bin and count. After all, the <code class="highlighter-rouge">Sketch</code> initialized with same width bins and <code class="highlighter-rouge">narrowUpdate</code>d is essentially the same as a conventional histogram. Of course, its performance is better than the conventional histogram due to the performance enhancements algorithms of <code class="highlighter-rouge">Sketch</code>. In this comparison, the xHistogram has an invariant optimal bins which are pre-adjusted from the prior knowledge of data stream. Therefore, the performance of xHistogram is the upper limit of the performance of <em>Flip</em>.</p>

<p>Online kernel density estimation, or oKDE for short, is an improvement for kernel density estimation to handle data streams with high performance. This algorithm is one of the best performance algorithms among density estimation.</p>

<p>I measure <em>Flip</em> in two environments: first, the case that <code class="highlighter-rouge">rearrange</code> to adjust bin periodically, and second, the case that <code class="highlighter-rouge">rearrange</code> only once when I know that the statistical property of the data stream is stationary.</p>

<p>The benchmark environment is the Macbook Pro 2016 with 2.9 GHz Intel Core i5 and 16 GB Memory. The forgetting factor of oKDE is set to 0.9. The result is obtained by updating 1000 data streams sampled from bimodal probability density function with a standard normal distribution centered at -2 and 2.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th><em>Flip</em> (periodic)</th>
      <th><em>Flip</em> (once)</th>
      <th>xHistogram</th>
      <th>oKDE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Execution Time (μs)</td>
      <td>8,363</td>
      <td>1,390</td>
      <td>539</td>
      <td>25,311</td>
    </tr>
    <tr>
      <td>KL-divergence</td>
      <td>0.02</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.25</td>
    </tr>
    <tr>
      <td>Euclidean distance</td>
      <td>0.18</td>
      <td>0.12</td>
      <td>0.11</td>
      <td>0.17</td>
    </tr>
  </tbody>
</table>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/flip/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script src="/flip/js/main.js"></script></body></html>